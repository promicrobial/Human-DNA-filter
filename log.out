Home directory set to /local/workdir/nc564/human_host_check/human_host_filtration
Checking requirements
# Directory: /local/workdir/nc564
Checking for config file
# Config file: /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Setting user defined variables
Beginning host filtration on directory: /local/workdir/nc564/human_host_check/human_host_filtration/data
+ config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
++ IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
++ OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
++ MODE=PE
++ METHODS=ALIGN-HPRC
++ SAVE_INTERMEDIATE=1
++ THREADS=30
++ METRIC=custom
++ THRESHOLD=0.175
++ MIN_RUN_LENGTH=5
++ CONDA_ENV_NAME=human-filtration
++ MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
++ MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
++ MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
++ ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
++ TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
++ '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
++ [[ PE != \P\E ]]
++ declare -A file_map
++ file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
++ file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
++ file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
++ file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
+ echo 'Beginning host filtration on directory: /local/workdir/nc564/human_host_check/human_host_filtration/data'
+ export TMPDIR=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ TMPDIR=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ mkdir -p /local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ echo /local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ find /local/workdir/nc564/human_host_check/human_host_filtration/data -maxdepth 1 -type f '(' -name '*_R1*.fastq' -o -name '*_R1*.fastq.gz' ')' -exec sh -c 'for f; do echo "$f"; done >> "$TMPDIR/r1_files.txt"' sh '{}' +
/local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ find /local/workdir/nc564/human_host_check/human_host_filtration/data -maxdepth 1 -type f '(' -name '*_R2*.fastq' -o -name '*_R2*.fastq.gz' ')' -exec sh -c 'for f; do echo "$f"; done >> "$TMPDIR/r2_files.txt"' sh '{}' +
+ find /local/workdir/nc564/human_host_check/human_host_filtration/data -maxdepth 1 -type f '(' -name '*.fastq' -o -name '*.fastq.gz' ')'
+ grep -vE '_R[12]'
fastq files found!
+ echo 'fastq files found!'
++ wc -l
+ echo 'Found 9 R1 FASTQ files'
Found 9 R1 FASTQ files
++ wc -l
+ echo 'Found 9 R2 FASTQ files'
Found 9 R2 FASTQ files
++ wc -l
++ wc -l
+ '[' 9 -eq 9 ']'
++ wc -l
+ echo 'Found 0 other files'
+ echo 'Processing filenames...'
Found 0 other files
Processing filenames...
+ paste /local/workdir/nc564/human_host_check/human_host_filtration/tmp/r1_files.txt /local/workdir/nc564/human_host_check/human_host_filtration/tmp/r2_files.txt
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Running ALIGN-HPRC filtration...
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Input file is compressed (.gz)
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.293*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.293*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.110*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.714*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.965 sec; CPU: 15.190 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.315*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.315*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.125*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.745*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.014 sec; CPU: 15.567 sec; Peak RSS: 7.692 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.147*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.147*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.962*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.556*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.849 sec; CPU: 15.273 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.361*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.361*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.182*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.815*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.065 sec; CPU: 15.288 sec; Peak RSS: 7.620 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.156*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.156*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::6.970*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.539*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.765 sec; CPU: 14.896 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.205*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.206*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.033*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.662*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.892 sec; CPU: 15.426 sec; Peak RSS: 7.612 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.140*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.140*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.942*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.517*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.761 sec; CPU: 15.165 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.111*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.111*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.951*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.576*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.800 sec; CPU: 15.329 sec; Peak RSS: 7.614 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
+ for key in "${METHODS[@]}"
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Input file is compressed (.gz)
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.270*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.270*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.092*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.676*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.927 sec; CPU: 15.492 sec; Peak RSS: 7.687 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.304*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.304*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.112*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.728*2.01] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.002 sec; CPU: 15.770 sec; Peak RSS: 7.659 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.244*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.244*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::7.045*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.669*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.914 sec; CPU: 15.342 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.254*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.254*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.065*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.674*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.955 sec; CPU: 15.385 sec; Peak RSS: 7.642 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.186*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.186*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::6.986*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.579*2.01] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.819 sec; CPU: 15.502 sec; Peak RSS: 7.598 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.338*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.338*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.157*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.766*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.048 sec; CPU: 15.623 sec; Peak RSS: 7.638 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.116*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.116*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.916*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.508*2.01] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.721 sec; CPU: 15.271 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.339*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.339*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::7.152*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.777*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.047 sec; CPU: 15.783 sec; Peak RSS: 7.631 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Input file is compressed (.gz)
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.320*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.320*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.143*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.707*1.91] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.945 sec; CPU: 14.984 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.436*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.436*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.256*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.874*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.152 sec; CPU: 15.607 sec; Peak RSS: 7.687 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.156*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.156*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.969*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.558*2.00] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.786 sec; CPU: 15.359 sec; Peak RSS: 7.601 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.281*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.281*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.111*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.725*1.91] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.926 sec; CPU: 14.968 sec; Peak RSS: 7.623 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.183*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.183*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::6.998*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.573*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.797 sec; CPU: 14.921 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.176*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.176*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::6.987*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.625*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.862 sec; CPU: 15.395 sec; Peak RSS: 7.607 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.170*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.170*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.988*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.582*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.865 sec; CPU: 15.291 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.040*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.040*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.837*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.484*2.01] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.753 sec; CPU: 15.344 sec; Peak RSS: 7.605 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Running ALIGN-HPRC filtration...
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Input file is compressed (.gz)
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.211*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.211*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.038*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.653*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.891 sec; CPU: 14.952 sec; Peak RSS: 7.619 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.331*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.331*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.153*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.769*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.054 sec; CPU: 15.629 sec; Peak RSS: 7.687 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.134*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.134*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.934*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.510*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.736 sec; CPU: 15.164 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.261*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.261*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.084*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.703*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.935 sec; CPU: 15.097 sec; Peak RSS: 7.625 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.235*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.235*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.048*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.627*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.852 sec; CPU: 15.094 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.152*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.152*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::6.950*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.595*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.801 sec; CPU: 15.331 sec; Peak RSS: 7.609 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.146*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.146*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.948*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.531*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.825 sec; CPU: 15.266 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.137*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.137*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.958*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.604*2.01] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.814 sec; CPU: 15.515 sec; Peak RSS: 7.606 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Input file is compressed (.gz)
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.266*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.266*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.088*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.656*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.906 sec; CPU: 14.962 sec; Peak RSS: 7.620 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.302*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.303*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.125*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.724*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.966 sec; CPU: 15.565 sec; Peak RSS: 7.688 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.172*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.172*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.987*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.575*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.806 sec; CPU: 15.237 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.338*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.338*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.136*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.771*1.84] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.118 sec; CPU: 14.585 sec; Peak RSS: 7.645 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.268*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.268*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.070*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.642*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.885 sec; CPU: 15.004 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.279*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.279*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.108*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.726*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.927 sec; CPU: 15.455 sec; Peak RSS: 7.619 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.172*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.172*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.994*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.619*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.876 sec; CPU: 15.294 sec; Peak RSS: 7.605 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.128*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.128*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.954*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.613*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.860 sec; CPU: 15.356 sec; Peak RSS: 7.611 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
+ for key in "${METHODS[@]}"
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Running ALIGN-HPRC filtration...
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Input file is compressed (.gz)
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.259*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.259*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.068*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.663*1.96] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.919 sec; CPU: 15.282 sec; Peak RSS: 7.662 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.275*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.275*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.096*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.684*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.951 sec; CPU: 15.418 sec; Peak RSS: 7.643 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.131*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.131*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.945*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.580*2.00] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.806 sec; CPU: 15.380 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.305*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.305*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.116*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.758*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.031 sec; CPU: 15.605 sec; Peak RSS: 7.639 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.300*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.300*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.116*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.688*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.942 sec; CPU: 15.057 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.336*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.336*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.156*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.794*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.032 sec; CPU: 15.572 sec; Peak RSS: 7.606 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.147*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.147*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.962*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.571*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.863 sec; CPU: 15.296 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.089*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.089*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.903*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.558*2.01] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.776 sec; CPU: 15.374 sec; Peak RSS: 7.606 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
+ for key in "${METHODS[@]}"
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Running ALIGN-HPRC filtration...
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Input file is compressed (.gz)
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.203*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.203*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.026*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.601*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.848 sec; CPU: 14.926 sec; Peak RSS: 7.623 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.343*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.343*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.149*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.854*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.124 sec; CPU: 15.857 sec; Peak RSS: 7.695 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.171*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.171*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.973*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.557*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.757 sec; CPU: 15.185 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.346*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.346*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.201*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.767*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.992 sec; CPU: 15.115 sec; Peak RSS: 7.645 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.231*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.231*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.048*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.619*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.851 sec; CPU: 14.974 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.205*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.205*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.082*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.661*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.891 sec; CPU: 15.381 sec; Peak RSS: 7.621 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.182*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.182*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.984*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.565*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.771 sec; CPU: 15.199 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.113*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.113*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.978*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.565*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.763 sec; CPU: 15.231 sec; Peak RSS: 7.626 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Input file is compressed (.gz)
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.158*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.158*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::6.985*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.556*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.787 sec; CPU: 14.889 sec; Peak RSS: 7.620 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.321*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.321*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.131*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.774*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.047 sec; CPU: 15.397 sec; Peak RSS: 7.696 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.149*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.149*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.963*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.550*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.777 sec; CPU: 15.211 sec; Peak RSS: 7.602 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.387*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.387*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.248*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.814*1.91] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.028 sec; CPU: 15.163 sec; Peak RSS: 7.648 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.221*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.221*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.023*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.595*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.826 sec; CPU: 15.078 sec; Peak RSS: 7.613 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.207*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.207*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.086*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.679*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.885 sec; CPU: 15.360 sec; Peak RSS: 7.635 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.200*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.200*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::7.017*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.640*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.885 sec; CPU: 15.312 sec; Peak RSS: 7.604 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.113*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.113*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.968*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.596*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.823 sec; CPU: 15.360 sec; Peak RSS: 7.616 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ echo 'Submitting /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz'
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 18: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 20: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 21: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 21: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 22: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 22: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 25: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 25: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 25: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 31: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 34: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 35: echo 'Input file is compressed (.gz)'
Input file is compressed (.gz)
Line 36: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 101: export -f run_minimap2
Line 102: export TMPDIR basename THREADS OUT
Line 105: [[ PE == *\P\E* ]]
Line 106: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.193*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.193*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.019*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.589*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.801 sec; CPU: 14.878 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.874*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.874*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.747*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::8.323*1.87] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.548 sec; CPU: 15.795 sec; Peak RSS: 7.702 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.151*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.151*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.951*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.538*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.757 sec; CPU: 15.207 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.241*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.241*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.105*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.674*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.902 sec; CPU: 15.050 sec; Peak RSS: 7.659 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.249*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.249*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.063*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.640*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.861 sec; CPU: 14.998 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.227*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.228*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.088*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.676*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.874 sec; CPU: 15.403 sec; Peak RSS: 7.643 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.225*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.225*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::7.041*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.616*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.835 sec; CPU: 15.291 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.140*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.140*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::7.004*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.587*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.782 sec; CPU: 15.276 sec; Peak RSS: 7.636 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ IFS='	'
+ read -r r1_file r2_file
+ IFS=
+ read -r file
+ echo 'Cleaning up /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
+ ls /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Cleaning up /local/workdir/nc564/human_host_check/human_host_filtration/tmp
other_files.txt
r1_files.txt
r2_files.txt
seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Pipeline complete
