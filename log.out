Home directory set to /local/workdir/nc564/human_host_check/human_host_filtration
Checking requirements
# Directory: /local/workdir/nc564
Checking for config file
# Config file: /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Setting user defined variables
+ config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
++ IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
++ OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
++ MODE=PE
++ METHODS=ALIGN-HPRC
++ SAVE_INTERMEDIATE=1
++ THREADS=30
++ METRIC=custom
++ THRESHOLD=0.175
++ MIN_RUN_LENGTH=5
++ CONDA_ENV_NAME=human-filtration
++ MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
++ MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
++ MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
++ ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
++ TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
++ '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
++ [[ PE != \P\E ]]
++ declare -A file_map
++ file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
++ file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
++ file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
++ file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
+ echo 'Beginning host filtration on directory: /local/workdir/nc564/human_host_check/human_host_filtration/data'
+ export TMPDIR=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ TMPDIR=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ mkdir -p /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Beginning host filtration on directory: /local/workdir/nc564/human_host_check/human_host_filtration/data
+ echo /local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ find /local/workdir/nc564/human_host_check/human_host_filtration/data -maxdepth 1 -type f '(' -name '*_R1*.fastq' -o -name '*_R1*.fastq.gz' ')' -exec sh -c 'for f; do echo "$f"; done >> "$TMPDIR/r1_files.txt"' sh '{}' +
/local/workdir/nc564/human_host_check/human_host_filtration/tmp
+ find /local/workdir/nc564/human_host_check/human_host_filtration/data -maxdepth 1 -type f '(' -name '*_R2*.fastq' -o -name '*_R2*.fastq.gz' ')' -exec sh -c 'for f; do echo "$f"; done >> "$TMPDIR/r2_files.txt"' sh '{}' +
+ find /local/workdir/nc564/human_host_check/human_host_filtration/data -maxdepth 1 -type f '(' -name '*.fastq' -o -name '*.fastq.gz' ')'
+ grep -vE '_R[12]'
fastq files found!
+ echo 'fastq files found!'
++ wc -l
Found 6 R1 FASTQ files
+ echo 'Found 6 R1 FASTQ files'
++ wc -l
Found 6 R2 FASTQ files
+ echo 'Found 6 R2 FASTQ files'
++ wc -l
++ wc -l
+ '[' 6 -eq 6 ']'
++ wc -l
Found 0 other files
Processing filenames...
+ echo 'Found 0 other files'
+ echo 'Processing filenames...'
+ paste /local/workdir/nc564/human_host_check/human_host_filtration/tmp/r1_files.txt /local/workdir/nc564/human_host_check/human_host_filtration/tmp/r2_files.txt
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 15: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 17: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 18: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 18: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 19: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 19: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 22: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 22: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 22: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 28: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 31: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 32: echo 'Input file is compressed (.gz)'
Input file is compressed (.gz)
Line 33: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 98: export -f run_minimap2
Line 99: export TMPDIR basename THREADS OUT
Line 102: [[ PE == *\P\E* ]]
Line 103: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.287*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.287*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.106*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.698*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.918 sec; CPU: 14.979 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.322*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.322*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.137*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.734*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.011 sec; CPU: 15.697 sec; Peak RSS: 7.693 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.146*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.146*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.958*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.535*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.777 sec; CPU: 15.203 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.358*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.358*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.185*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.799*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.028 sec; CPU: 15.218 sec; Peak RSS: 7.625 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.235*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.235*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.049*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.656*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.907 sec; CPU: 15.028 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.212*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.212*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.039*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.692*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.924 sec; CPU: 15.450 sec; Peak RSS: 7.606 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.170*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.170*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.988*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.571*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.811 sec; CPU: 15.213 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Error: Output file '/local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz' does not exist.
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.153*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.153*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.978*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.609*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.840 sec; CPU: 15.320 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Line 15: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 17: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 18: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 18: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 19: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 19: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 22: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 22: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 22: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 28: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 31: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 32: echo 'Input file is compressed (.gz)'
Line 33: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Input file is compressed (.gz)
Line 98: export -f run_minimap2
Line 99: export TMPDIR basename THREADS OUT
Line 102: [[ PE == *\P\E* ]]
Line 103: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.202*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.202*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.028*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.599*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.839 sec; CPU: 15.035 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.307*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.307*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.141*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.744*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.023 sec; CPU: 15.338 sec; Peak RSS: 7.687 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.244*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.244*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::7.058*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.645*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.944 sec; CPU: 15.369 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.356*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.356*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.161*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.786*1.91] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.037 sec; CPU: 15.154 sec; Peak RSS: 7.626 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.125*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.125*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::6.939*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.532*2.00] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.747 sec; CPU: 15.303 sec; Peak RSS: 7.598 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::7.246*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::7.246*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::8.126*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::8.689*1.82] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.888 sec; CPU: 15.974 sec; Peak RSS: 7.644 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.278*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.278*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::7.080*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.663*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.884 sec; CPU: 15.317 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Error: Output file '/local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz' does not exist.
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.079*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.079*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.954*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.540*2.00] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.764 sec; CPU: 15.281 sec; Peak RSS: 7.635 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 15: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 17: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 18: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 18: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 19: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 19: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 22: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 22: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 22: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 28: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 31: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 32: echo 'Input file is compressed (.gz)'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 33: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Input file is compressed (.gz)
Line 98: export -f run_minimap2
Line 99: export TMPDIR basename THREADS OUT
Line 102: [[ PE == *\P\E* ]]
Line 103: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.199*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.199*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.022*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.597*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.826 sec; CPU: 14.936 sec; Peak RSS: 7.622 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.355*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.355*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.165*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.811*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.100 sec; CPU: 15.409 sec; Peak RSS: 7.696 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.150*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.150*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.951*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.577*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.784 sec; CPU: 15.221 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.295*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.295*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.153*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.813*1.91] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.044 sec; CPU: 15.186 sec; Peak RSS: 7.641 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.219*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.219*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.023*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.597*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.812 sec; CPU: 15.000 sec; Peak RSS: 7.611 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.172*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.172*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.045*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.631*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.843 sec; CPU: 15.264 sec; Peak RSS: 7.634 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.220*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.220*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::7.036*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.622*1.97] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.864 sec; CPU: 15.275 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.117*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.117*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.957*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.566*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.790 sec; CPU: 15.305 sec; Peak RSS: 7.619 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Error: Output file '/local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz' does not exist.
/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh: line 106: syntax error near unexpected token `fi'
/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh: line 106: `fi'
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Running ALIGN-HPRC filtration...
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 15: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 17: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 18: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 18: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 19: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 19: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 22: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 22: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 22: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 28: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 31: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 32: echo 'Input file is compressed (.gz)'
Input file is compressed (.gz)
Line 33: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 98: export -f run_minimap2
Line 99: export TMPDIR basename THREADS OUT
Line 102: [[ PE == *\P\E* ]]
Line 103: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.280*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.280*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.102*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.670*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.915 sec; CPU: 14.989 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.354*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.354*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.175*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.775*1.96] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.059 sec; CPU: 15.536 sec; Peak RSS: 7.689 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.156*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.156*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.970*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.556*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.801 sec; CPU: 15.237 sec; Peak RSS: 7.601 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.361*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.361*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.183*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.797*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.019 sec; CPU: 15.182 sec; Peak RSS: 7.622 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.213*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.213*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::7.015*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.630*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.883 sec; CPU: 15.011 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.199*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.199*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.015*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.668*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.901 sec; CPU: 15.432 sec; Peak RSS: 7.612 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.162*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.162*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.977*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.568*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.822 sec; CPU: 15.239 sec; Peak RSS: 7.604 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Error: Output file '/local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz' does not exist.
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.113*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.113*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.914*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.565*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.773 sec; CPU: 15.287 sec; Peak RSS: 7.611 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 15: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 17: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 18: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 18: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 19: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 19: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 22: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 22: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Line 22: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 28: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Input file is compressed (.gz)
Line 31: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 32: echo 'Input file is compressed (.gz)'
Line 33: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 98: export -f run_minimap2
Line 99: export TMPDIR basename THREADS OUT
Line 102: [[ PE == *\P\E* ]]
Line 103: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.227*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.227*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.039*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.606*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.823 sec; CPU: 14.886 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.406*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.406*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.218*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.852*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.085 sec; CPU: 15.572 sec; Peak RSS: 7.687 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.141*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.141*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.956*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.581*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.816 sec; CPU: 15.260 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.313*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.313*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.175*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.782*1.92] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.015 sec; CPU: 15.167 sec; Peak RSS: 7.630 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.144*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.145*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::6.959*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.570*1.94] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.776 sec; CPU: 14.924 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.168*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.168*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::7.021*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.626*1.98] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.827 sec; CPU: 15.300 sec; Peak RSS: 7.625 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.113*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.113*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.914*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.495*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.687 sec; CPU: 15.133 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.106*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.106*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.982*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.563*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.760 sec; CPU: 15.232 sec; Peak RSS: 7.637 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Error: Output file '/local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz' does not exist.
+ IFS='	'
+ read -r r1_file r2_file
+ process_files /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local r1_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ local r2_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
+ local base_name
+ local base_name_r2
+ [[ -n /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz ]]
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
+ base_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
++ strip_extensions /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local file_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2.fastq.gz
++ local stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ stripped_name=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
++ echo /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ base_name_r2=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R2
+ [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000 != \/\l\o\c\a\l\/\w\o\r\k\d\i\r\/\n\c\5\6\4\/\h\u\m\a\n\_\h\o\s\t\_\c\h\e\c\k\/\h\u\m\a\n\_\h\o\s\t\_\f\i\l\t\r\a\t\i\o\n\/\d\a\t\a\/\5\0\.\0\0\p\-\H\G\0\0\2\.\m\a\t\e\r\n\a\l\_\5\0\.\0\0\p\-\F\D\A\-\A\R\G\O\-\4\1\_\s\i\m\_\S\U\B\-\h\1\0\0\0\0\0\-\m\1\0\0\0\0\0 ]]
+ in_file=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
+ for key in "${METHODS[@]}"
+ local script=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
+ [[ -f /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh ]]
Running ALIGN-HPRC filtration...
+ echo 'Running ALIGN-HPRC filtration...'
+ bash /local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
+ export 'PS4=Line $LINENO: '
+ PS4='Line $LINENO: '
Line 12: config_fn=/local/workdir/nc564/human_host_check/human_host_filtration/config.sh
Line 13: source /local/workdir/nc564/human_host_check/human_host_filtration/config.sh
LLine 4: IN=/local/workdir/nc564/human_host_check/human_host_filtration/data
LLine 5: OUT=/local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 6: MODE=PE
LLine 7: METHODS=ALIGN-HPRC
LLine 8: SAVE_INTERMEDIATE=1
LLine 9: THREADS=30
LLine 12: METRIC=custom
LLine 13: THRESHOLD=0.175
LLine 14: MIN_RUN_LENGTH=5
LLine 17: CONDA_ENV_NAME=human-filtration
LLine 21: MINIMAP2_HG38_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/hg38.mmi
LLine 22: MINIMAP2_T2T_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/t2t.mmi
LLine 23: MINIMAP2_HPRC_INDEX_PATH=/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test
LLine 24: ADAPTERS=/local/workdir/nc564/human_host_check/human_host_filtration/ref/known_adapters.fna
LLine 25: TMP=/local/workdir/nc564/human_host_check/human_host_filtration/tmp
LLine 30: '[' -z /local/workdir/nc564/human_host_check/human_host_filtration/tmp ']'
LLine 36: [[ PE != \P\E ]]
LLine 42: declare -A file_map
LLine 43: file_map["ALIGN-HG38"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hg38.sh
LLine 44: file_map["ALIGN-T2T"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_t2t.sh
LLine 45: file_map["ALIGN-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_align_hprc.sh
Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
LLine 46: file_map["INDEX-HPRC"]=/local/workdir/nc564/human_host_check/human_host_filtration/filter_index_hprc.sh
Line 15: echo 'Output directory = /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered'
Line 17: f=/local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 18: basename /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq
Line 18: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
LLine 19: basename 50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz .fastq.gz
Line 19: basename=50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1
Line 22: '[' '!' -d /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test ']'
LLine 22: ls -A /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi
Line 22: '[' -z '/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi
/local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi' ']'
Line 28: echo 'Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
Line 31: [[ /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz == *.gz ]]
Line 32: echo 'Input file is compressed (.gz)'
Saving temporary files to /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Input file is compressed (.gz)
Line 33: cp /local/workdir/nc564/human_host_check/human_host_filtration/data/50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Line 98: export -f run_minimap2
Line 99: export TMPDIR basename THREADS OUT
Line 102: [[ PE == *\P\E* ]]
Line 103: parallel -j 2 run_minimap2 ::: /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi ::: PE ::: /local/workdir/nc564/human_host_check/human_host_filtration/data/host-filtered
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.193*1.00] loaded/built the index for 304 target sequence(s)
[M::mm_mapopt_update::6.193*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 304
[M::mm_idx_stat::7.004*1.00] distinct minimizers: 100085112 (38.72% are singletons); average occurrences: 5.733; average spacing: 5.309; total length: 3046330261
[M::worker_pipeline::7.581*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.795 sec; CPU: 14.842 sec; Peak RSS: 7.618 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.384*1.00] loaded/built the index for 271 target sequence(s)
[M::mm_mapopt_update::6.384*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 271
[M::mm_idx_stat::7.205*1.00] distinct minimizers: 100085843 (38.71% are singletons); average occurrences: 5.751; average spacing: 5.309; total length: 3055692855
[M::worker_pipeline::7.837*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 8.080 sec; CPU: 15.355 sec; Peak RSS: 7.667 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA18906.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.055*1.00] loaded/built the index for 387 target sequence(s)
[M::mm_mapopt_update::6.055*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 387
[M::mm_idx_stat::6.869*1.00] distinct minimizers: 100078639 (38.76% are singletons); average occurrences: 5.705; average spacing: 5.310; total length: 3032066086
[M::worker_pipeline::7.456*2.00] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.693 sec; CPU: 15.123 sec; Peak RSS: 7.600 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.181*1.00] loaded/built the index for 453 target sequence(s)
[M::mm_mapopt_update::6.181*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 453
[M::mm_idx_stat::7.038*1.00] distinct minimizers: 100078404 (38.78% are singletons); average occurrences: 5.718; average spacing: 5.310; total length: 3038325696
[M::worker_pipeline::7.621*1.93] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA19240.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.820 sec; CPU: 14.937 sec; Peak RSS: 7.626 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.120*1.00] loaded/built the index for 448 target sequence(s)
[M::mm_mapopt_update::6.120*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 448
[M::mm_idx_stat::6.935*1.00] distinct minimizers: 100089699 (38.82% are singletons); average occurrences: 5.730; average spacing: 5.310; total length: 3045049146
[M::worker_pipeline::7.508*1.95] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.748 sec; CPU: 14.877 sec; Peak RSS: 7.610 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.127*1.00] loaded/built the index for 481 target sequence(s)
[M::mm_mapopt_update::6.127*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 481
[M::mm_idx_stat::6.961*1.00] distinct minimizers: 100089553 (38.81% are singletons); average occurrences: 5.699; average spacing: 5.310; total length: 3029071557
[M::worker_pipeline::7.569*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA20129.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.777 sec; CPU: 15.306 sec; Peak RSS: 7.616 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.111*1.00] loaded/built the index for 501 target sequence(s)
[M::mm_mapopt_update::6.111*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 501
[M::mm_idx_stat::6.912*1.00] distinct minimizers: 100076542 (38.86% are singletons); average occurrences: 5.714; average spacing: 5.310; total length: 3036587447
[M::worker_pipeline::7.493*1.99] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.maternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.740 sec; CPU: 15.181 sec; Peak RSS: 7.603 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
Running minimap2 (PE) on /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi and /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Error: Output file '/local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_new_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz' does not exist.
[WARNING][1;31m Indexing parameters (-k, -w or -H) overridden by parameters used in the prebuilt index.[0m
[M::main::6.054*1.00] loaded/built the index for 608 target sequence(s)
[M::mm_mapopt_update::6.054*1.00] mid_occ = 1000
[M::mm_idx_stat] kmer size: 15; skip: 10; is_hpc: 0; #seq: 608
[M::mm_idx_stat::6.889*1.00] distinct minimizers: 100071116 (38.84% are singletons); average occurrences: 5.701; average spacing: 5.310; total length: 3029616838
[M::worker_pipeline::7.537*2.00] mapped 100000 sequences
[M::main] Version: 2.26-r1175
[M::main] CMD: minimap2 -2 -ax sr -t 30 /local/workdir/nc564/human_host_check/human_host_filtration/ref/mmi/test/NA21309.paternal.f1_assembly_v2_genbank.mmi /local/workdir/nc564/human_host_check/human_host_filtration/tmp/seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
[M::main] Real time: 7.729 sec; CPU: 15.243 sec; Peak RSS: 7.613 GB
[M::bam2fq_mainloop] discarded 0 singletons
[M::bam2fq_mainloop] processed 0 reads
+ IFS='	'
+ read -r r1_file r2_file
+ IFS=
+ read -r file
+ echo 'Cleaning up /local/workdir/nc564/human_host_check/human_host_filtration/tmp'
+ ls /local/workdir/nc564/human_host_check/human_host_filtration/tmp
Cleaning up /local/workdir/nc564/human_host_check/human_host_filtration/tmp
other_files.txt
r1_files.txt
r2_files.txt
seqs_50.00p-HG002.maternal_50.00p-FDA-ARGO-41_sim_SUB-h100000-m100000_R1.fastq.gz
Pipeline complete
